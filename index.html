<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Audax Ocean Support - Panel de Control TI</title>
    
    <link rel="stylesheet" href="base.css">
    <link rel="stylesheet" href="components.css">
    <link rel="stylesheet" href="dashboard.css">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

    <div class="ocean-decoration">
        <div class="bubble b1"></div>
        <div class="bubble b2"></div>
        <div class="bubble b3"></div>
    </div>

    <div id="loaderSistema" class="loader-container" style="display: none;">
        <div class="bubble-spinner"></div>
        <p id="loaderTexto">Procesando...</p>
    </div>

    <nav class="navbar glass">
        <div class="nav-logo">
            <span class="icon">üåä</span> 
            <span class="logo-text">SOPORTE TI</span>
        </div>
        <div class="nav-actions">
            <button onclick="mostrarSeccion('seccionCliente')" class="btn-nav">Solicitar Soporte</button>
            <button onclick="mostrarSeccion('seccionLogin')" class="btn-nav">Panel Sistemas</button>
            <button onclick="toggleTheme()" id="themeBtn" class="btn-theme">üåô</button>
        </div>
    </nav>

    <section id="seccionCliente" class="container glass fade-in">
        <div id="ticketContenedor">
            <div class="header-main">
                <h1>Centro de Soporte</h1>
                <p>Gran Acuario Mazatl√°n Mar de Cort√©s</p>
            </div>
            
            <form id="ticketForm" class="form-glass">
                <input type="text" id="usuario" placeholder="Nombre del solicitante" required>
                
                <select id="departamento" required>
                    <option value="" disabled selected>Selecciona tu Departamento</option>
                    <option value="ADMINISTRACI√ìN Y FINANZAS">ADMINISTRACI√ìN Y FINANZAS</option>
                    <option value="VENTAS (RELACIONES P√öBLICAS)">VENTAS (RELACIONES P√öBLICAS)</option>
                    <option value="COMUNICACI√ìN DE LA CIENCIA">COMUNICACI√ìN DE LA CIENCIA</option>
                    <option value="CIENCIAS DE LA VIDA">CIENCIAS DE LA VIDA</option>
                    <option value="TAQUILLA">TAQUILLA</option>
                    <option value="MANTENIMIENTO">MANTENIMIENTO</option>
                    <option value="SISTEMAS">SISTEMAS</option>
                </select>

                <select id="prioridad" required>
                    <option value="" disabled selected>Nivel de Urgencia</option>
                    <option value="Baja">Baja - Consulta General</option>
                    <option value="Media">Media - Falla Parcial</option>
                    <option value="Alta">Alta - Operaci√≥n Detenida</option>
                </select>

                <textarea id="descripcion" placeholder="Describe el problema t√©cnico detalladamente..." required></textarea>

                <div class="file-upload glass">
                    <label>üì∏ Evidencia Fotogr√°fica (C√°mara o Galer√≠a)</label>
                    <input type="file" id="evidencia" accept="image/*" capture="environment" onchange="previewImage(this)">
                    
                    <div id="previewContainer" style="display:none; margin-top: 15px; position: relative;">
                        <img id="imagePreview" src="#" alt="Vista previa">
                        <button type="button" class="btn-remove-photo" onclick="quitarFoto()">‚úï</button>
                    </div>
                </div>

                <button type="submit" class="btn-submit">Enviar Solicitud</button>
            </form>
        </div>

        <div id="ticketConfirmacion" class="fade-in" style="display:none;">
            <div class="card-folio glass">
                <span class="ticket-icon">üé´</span>
                <h2>¬°Solicitud Recibida!</h2>
                <p>Tu reporte ha sido registrado con el folio:</p>
                <div id="numeroFolio" class="folio-badge">Generando...</div>
                <button onclick="location.reload()" class="btn-submit">Generar otro reporte</button>
            </div>
        </div>
    </section>

    <section id="seccionLogin" class="container glass fade-in" style="display:none;">
        <div class="header-main">
            <h2>Acceso Restringido</h2>
            <p>Ingresa tus credenciales de t√©cnico</p>
        </div>
        <div class="form-glass">
            <input type="text" id="adminUser" placeholder="Usuario">
            <input type="password" id="adminPass" placeholder="Contrase√±a">
            <button onclick="verificarAcceso()" class="btn-submit">Entrar al Panel</button>
        </div>
    </section>

    <section id="seccionAdmin" class="dashboard-wrapper glass" style="display:none;">
        <header class="dashboard-header">
            <div class="header-content">
                <h1>Panel de Control TI</h1>
                <p>Sesi√≥n activa: <b id="nombreAdmin">T√©cnico</b></p>
            </div>
            <button onclick="cerrarSesion()" class="btn-logout">Cerrar Sesi√≥n</button>
        </header>

        <div class="stats-row">
            <div class="stat-card glass-vibrant clickable" onclick="filtrarPorEstado('Pendiente')">
                <span class="stat-icon">‚è≥</span>
                <div class="stat-info">
                    <h3>Pendientes</h3>
                    <p id="countPendientes" class="stat-number">0</p>
                </div>
            </div>
            <div class="stat-card glass-vibrant clickable" onclick="filtrarPorEstado('Resuelto')">
                <span class="stat-icon">‚úÖ</span>
                <div class="stat-info">
                    <h3>Resueltos</h3>
                    <p id="countResueltos" class="stat-number">0</p>
                </div>
            </div>
        </div>

        <div class="chart-section glass">
            <h3>üìä Estatus general</h3>
            <div class="canvas-wrapper">
                <canvas id="graficaTickets"></canvas>
            </div>
        </div>

        <div class="work-section glass">
            <div class="table-header">
                <h3 id="tituloTabla">üì® Tickets en Bandeja</h3>
                <div class="table-tools">
                    <input type="text" id="buscador" placeholder="üîç Buscar ticket..." onkeyup="buscarTicketRealTime()">
                    <button onclick="actualizarDashboard()" class="btn-tool">üîÑ</button>
                    <button onclick="exportarExcel()" class="btn-tool excel">üì• Excel</button>
                </div>
            </div>

            <div class="table-wrapper">
                <table id="tablaTrabajo">
                    <thead>
                        <tr>
                            <th>Folio / Fecha</th>
                            <th>Solicitante</th>
                            <th>Departamento</th>
                            <th>Prioridad</th>
                            <th>Acci√≥n</th>
                        </tr>
                    </thead>
                    <tbody id="cuerpoTabla"></tbody>
                </table>
            </div>
        </div>

        <div id="gestionUsuarios" class="admin-section glass-vibrant" style="display:none;">
            <div class="section-title">
                <h3>üõ†Ô∏è Alta de Usuarios TI</h3>
                <p>Configuraci√≥n de personal t√©cnico autorizado</p>
            </div>
            <form id="formRegistroTI" class="admin-form-inline">
                <input type="text" id="regNombre" placeholder="Nombre Completo" required>
                <input type="text" id="regUser" placeholder="Usuario" required>
                <input type="password" id="regPass" placeholder="Contrase√±a" required>
                <input type="text" id="regDepto" placeholder="Puesto/Depto" required>
                <div class="file-small">
                    <label title="Subir Foto">üì∏</label>
                    <input type="file" id="regFoto" accept="image/*">
                </div>
                <button type="submit" class="btn-save">Registrar T√©cnico</button>
            </form>
            
            <div class="table-mini-wrapper">
                <table class="mini-table">
                    <thead>
                        <tr>
                            <th>Foto</th>
                            <th>Usuario</th>
                            <th>Nombre</th>
                            <th>Estatus</th>
                        </tr>
                    </thead>
                    <tbody id="listaTecnicosCompleta"></tbody>
                </table>
            </div>
        </div>
    </section>

    <script src="main.js"></script>
    <script src="tickets.js"></script>
    <script src="admin.js"></script>
</body>
</html>